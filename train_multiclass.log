checkpoint path: checkpoints_multi/ic15_resnet152_bs_96_ep_35
init lr: 0.00100000
schedule:  [10, 20]
Training from scratch.

Epoch: [1 | 35] LR: 0.001000
Traceback (most recent call last):
  File "train_multiclass.py", line 304, in <module>
    main(args)
  File "train_multiclass.py", line 268, in main
    train_loss, val_loss = train(train_loader, val_loader, model, LossCL, optimizer, epoch)
  File "train_multiclass.py", line 116, in train
    outputs = model(imgs)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py", line 152, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/parallel/data_parallel.py", line 162, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py", line 85, in parallel_apply
    output.reraise()
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/_utils.py", line 394, in reraise
    raise self.exc_type(msg)
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/parallel/parallel_apply.py", line 60, in _worker
    output = module(*input, **kwargs)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/zhangyangsong/IMA205/models/resnet.py", line 161, in forward
    h = self.layer4(h)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/zhangyangsong/IMA205/models/resnet.py", line 84, in forward
    out = self.conv3(out)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 345, in forward
    return self.conv2d_forward(input, self.weight)
  File "/home/zhangyangsong/env1/lib/python3.6/site-packages/torch/nn/modules/conv.py", line 342, in conv2d_forward
    self.padding, self.dilation, self.groups)
RuntimeError: CUDA out of memory. Tried to allocate 16.00 MiB (GPU 0; 7.93 GiB total capacity; 7.14 GiB already allocated; 6.56 MiB free; 7.39 GiB reserved in total by PyTorch)

checkpoint path: checkpoints_multi/ic15_resnet152_bs_96_ep_35
init lr: 0.00100000
schedule:  [10, 20]
Training from scratch.

Epoch: [1 | 35] LR: 0.001000
(1/22) Batch: 9.841s | TOTAL: 0min | ETA: 4min | Loss: 2.1881
(11/22) Batch: 1.564s | TOTAL: 0min | ETA: 0min | Loss: 1.9322
(21/22) Batch: 1.170s | TOTAL: 0min | ETA: 0min | Loss: 1.8444
Validation: (1/10) Batch: 1.317s | TOTAL: 0min | ETA: 0min | Loss: 1.4135
Validation: (6/10) Batch: 0.449s | TOTAL: 0min | ETA: 0min | Loss: 1.4493

Epoch: [2 | 35] LR: 0.001000
(1/22) Batch: 1.724s | TOTAL: 0min | ETA: 1min | Loss: 1.3601
(11/22) Batch: 0.826s | TOTAL: 0min | ETA: 0min | Loss: 1.0443
(21/22) Batch: 0.782s | TOTAL: 0min | ETA: 0min | Loss: 0.9102
Validation: (1/10) Batch: 1.237s | TOTAL: 0min | ETA: 0min | Loss: 0.6262
Validation: (6/10) Batch: 0.441s | TOTAL: 0min | ETA: 0min | Loss: 0.7200

Epoch: [3 | 35] LR: 0.001000
(1/22) Batch: 3.028s | TOTAL: 0min | ETA: 1min | Loss: 0.5223
(11/22) Batch: 0.946s | TOTAL: 0min | ETA: 0min | Loss: 0.6528
(21/22) Batch: 0.846s | TOTAL: 0min | ETA: 0min | Loss: 0.6079
Validation: (1/10) Batch: 1.331s | TOTAL: 0min | ETA: 0min | Loss: 0.5366
Validation: (6/10) Batch: 0.456s | TOTAL: 0min | ETA: 0min | Loss: 0.5879

Epoch: [4 | 35] LR: 0.001000
(1/22) Batch: 1.951s | TOTAL: 0min | ETA: 1min | Loss: 0.4455
(11/22) Batch: 0.849s | TOTAL: 0min | ETA: 0min | Loss: 0.5482
(21/22) Batch: 0.796s | TOTAL: 0min | ETA: 0min | Loss: 0.5114
Validation: (1/10) Batch: 1.295s | TOTAL: 0min | ETA: 0min | Loss: 0.5503
Validation: (6/10) Batch: 0.446s | TOTAL: 0min | ETA: 0min | Loss: 0.5150

Epoch: [5 | 35] LR: 0.001000
(1/22) Batch: 2.747s | TOTAL: 0min | ETA: 1min | Loss: 0.4466
(11/22) Batch: 0.923s | TOTAL: 0min | ETA: 0min | Loss: 0.5008
(21/22) Batch: 0.835s | TOTAL: 0min | ETA: 0min | Loss: 0.5107
Validation: (1/10) Batch: 1.332s | TOTAL: 0min | ETA: 0min | Loss: 0.2246
Validation: (6/10) Batch: 0.454s | TOTAL: 0min | ETA: 0min | Loss: 0.5688

Epoch: [6 | 35] LR: 0.001000
(1/22) Batch: 1.811s | TOTAL: 0min | ETA: 1min | Loss: 0.4200
(11/22) Batch: 0.839s | TOTAL: 0min | ETA: 0min | Loss: 0.4890
(21/22) Batch: 0.793s | TOTAL: 0min | ETA: 0min | Loss: 0.4473
Validation: (1/10) Batch: 1.312s | TOTAL: 0min | ETA: 0min | Loss: 0.5694
Validation: (6/10) Batch: 0.453s | TOTAL: 0min | ETA: 0min | Loss: 0.5096

Epoch: [7 | 35] LR: 0.001000
(1/22) Batch: 1.890s | TOTAL: 0min | ETA: 1min | Loss: 0.4879
(11/22) Batch: 0.851s | TOTAL: 0min | ETA: 0min | Loss: 0.4327
(21/22) Batch: 0.804s | TOTAL: 0min | ETA: 0min | Loss: 0.4799
Validation: (1/10) Batch: 1.329s | TOTAL: 0min | ETA: 0min | Loss: 0.3294
Validation: (6/10) Batch: 0.456s | TOTAL: 0min | ETA: 0min | Loss: 0.4578

Epoch: [8 | 35] LR: 0.001000
(1/22) Batch: 2.920s | TOTAL: 0min | ETA: 1min | Loss: 0.5325
(11/22) Batch: 0.948s | TOTAL: 0min | ETA: 0min | Loss: 0.4810
(21/22) Batch: 0.859s | TOTAL: 0min | ETA: 0min | Loss: 0.5023
Validation: (1/10) Batch: 1.500s | TOTAL: 0min | ETA: 0min | Loss: 0.3550
Validation: (6/10) Batch: 0.487s | TOTAL: 0min | ETA: 0min | Loss: 0.4203

Epoch: [9 | 35] LR: 0.001000
(1/22) Batch: 1.894s | TOTAL: 0min | ETA: 1min | Loss: 0.4240
(11/22) Batch: 0.857s | TOTAL: 0min | ETA: 0min | Loss: 0.4615
(21/22) Batch: 0.812s | TOTAL: 0min | ETA: 0min | Loss: 0.4568
Validation: (1/10) Batch: 1.362s | TOTAL: 0min | ETA: 0min | Loss: 0.3363
Validation: (6/10) Batch: 0.463s | TOTAL: 0min | ETA: 0min | Loss: 0.3970

Epoch: [10 | 35] LR: 0.001000
(1/22) Batch: 1.897s | TOTAL: 0min | ETA: 1min | Loss: 0.3664
(11/22) Batch: 0.866s | TOTAL: 0min | ETA: 0min | Loss: 0.4246
(21/22) Batch: 0.818s | TOTAL: 0min | ETA: 0min | Loss: 0.4140
Validation: (1/10) Batch: 1.324s | TOTAL: 0min | ETA: 0min | Loss: 0.3226
Validation: (6/10) Batch: 0.459s | TOTAL: 0min | ETA: 0min | Loss: 0.3735

Epoch: [11 | 35] LR: 0.000100
(1/22) Batch: 1.808s | TOTAL: 0min | ETA: 1min | Loss: 0.4101
(11/22) Batch: 0.863s | TOTAL: 0min | ETA: 0min | Loss: 0.4104
(21/22) Batch: 0.818s | TOTAL: 0min | ETA: 0min | Loss: 0.3656
Validation: (1/10) Batch: 1.270s | TOTAL: 0min | ETA: 0min | Loss: 0.2863
Validation: (6/10) Batch: 0.450s | TOTAL: 0min | ETA: 0min | Loss: 0.3121

Epoch: [12 | 35] LR: 0.000100
(1/22) Batch: 2.722s | TOTAL: 0min | ETA: 1min | Loss: 0.2675
(11/22) Batch: 0.944s | TOTAL: 0min | ETA: 0min | Loss: 0.3092
(21/22) Batch: 0.860s | TOTAL: 0min | ETA: 0min | Loss: 0.3164
Validation: (1/10) Batch: 1.295s | TOTAL: 0min | ETA: 0min | Loss: 0.2169
Validation: (6/10) Batch: 0.456s | TOTAL: 0min | ETA: 0min | Loss: 0.3221

Epoch: [13 | 35] LR: 0.000100
(1/22) Batch: 1.904s | TOTAL: 0min | ETA: 1min | Loss: 0.3142
(11/22) Batch: 0.871s | TOTAL: 0min | ETA: 0min | Loss: 0.3209
(21/22) Batch: 0.821s | TOTAL: 0min | ETA: 0min | Loss: 0.3084
Validation: (1/10) Batch: 1.312s | TOTAL: 0min | ETA: 0min | Loss: 0.3650
Validation: (6/10) Batch: 0.457s | TOTAL: 0min | ETA: 0min | Loss: 0.3019

Epoch: [14 | 35] LR: 0.000100
(1/22) Batch: 3.126s | TOTAL: 0min | ETA: 1min | Loss: 0.3419
(11/22) Batch: 0.984s | TOTAL: 0min | ETA: 0min | Loss: 0.3120
(21/22) Batch: 0.883s | TOTAL: 0min | ETA: 0min | Loss: 0.3175
Validation: (1/10) Batch: 1.329s | TOTAL: 0min | ETA: 0min | Loss: 0.2277
Validation: (6/10) Batch: 0.459s | TOTAL: 0min | ETA: 0min | Loss: 0.2812

Epoch: [15 | 35] LR: 0.000100
(1/22) Batch: 1.854s | TOTAL: 0min | ETA: 1min | Loss: 0.4092
(11/22) Batch: 0.869s | TOTAL: 0min | ETA: 0min | Loss: 0.2961
(21/22) Batch: 0.821s | TOTAL: 0min | ETA: 0min | Loss: 0.2905
Validation: (1/10) Batch: 1.304s | TOTAL: 0min | ETA: 0min | Loss: 0.3422
Validation: (6/10) Batch: 0.457s | TOTAL: 0min | ETA: 0min | Loss: 0.2931

Epoch: [16 | 35] LR: 0.000100
(1/22) Batch: 1.931s | TOTAL: 0min | ETA: 1min | Loss: 0.3447
(11/22) Batch: 0.879s | TOTAL: 0min | ETA: 0min | Loss: 0.2678
(21/22) Batch: 0.828s | TOTAL: 0min | ETA: 0min | Loss: 0.2829
Validation: (1/10) Batch: 1.301s | TOTAL: 0min | ETA: 0min | Loss: 0.3255
Validation: (6/10) Batch: 0.457s | TOTAL: 0min | ETA: 0min | Loss: 0.3563

Epoch: [17 | 35] LR: 0.000100
(1/22) Batch: 1.915s | TOTAL: 0min | ETA: 1min | Loss: 0.2461
(11/22) Batch: 0.877s | TOTAL: 0min | ETA: 0min | Loss: 0.2826
(21/22) Batch: 0.825s | TOTAL: 0min | ETA: 0min | Loss: 0.2694
Validation: (1/10) Batch: 1.275s | TOTAL: 0min | ETA: 0min | Loss: 0.3076
Validation: (6/10) Batch: 0.453s | TOTAL: 0min | ETA: 0min | Loss: 0.3113

Epoch: [18 | 35] LR: 0.000100
(1/22) Batch: 1.874s | TOTAL: 0min | ETA: 1min | Loss: 0.4657
(11/22) Batch: 0.869s | TOTAL: 0min | ETA: 0min | Loss: 0.2901
(21/22) Batch: 0.822s | TOTAL: 0min | ETA: 0min | Loss: 0.2810
Validation: (1/10) Batch: 1.394s | TOTAL: 0min | ETA: 0min | Loss: 0.2245
Validation: (6/10) Batch: 0.472s | TOTAL: 0min | ETA: 0min | Loss: 0.2903

Epoch: [19 | 35] LR: 0.000100
(1/22) Batch: 1.811s | TOTAL: 0min | ETA: 1min | Loss: 0.2911
(11/22) Batch: 0.868s | TOTAL: 0min | ETA: 0min | Loss: 0.2843
(21/22) Batch: 0.820s | TOTAL: 0min | ETA: 0min | Loss: 0.2714
Validation: (1/10) Batch: 1.268s | TOTAL: 0min | ETA: 0min | Loss: 0.2970
Validation: (6/10) Batch: 0.450s | TOTAL: 0min | ETA: 0min | Loss: 0.2644

Epoch: [20 | 35] LR: 0.000100
(1/22) Batch: 1.837s | TOTAL: 0min | ETA: 1min | Loss: 0.2324
(11/22) Batch: 0.870s | TOTAL: 0min | ETA: 0min | Loss: 0.2724
(21/22) Batch: 0.823s | TOTAL: 0min | ETA: 0min | Loss: 0.2724
Validation: (1/10) Batch: 1.325s | TOTAL: 0min | ETA: 0min | Loss: 0.3508
Validation: (6/10) Batch: 0.465s | TOTAL: 0min | ETA: 0min | Loss: 0.2761

Epoch: [21 | 35] LR: 0.000010
(1/22) Batch: 1.850s | TOTAL: 0min | ETA: 1min | Loss: 0.3038
(11/22) Batch: 0.873s | TOTAL: 0min | ETA: 0min | Loss: 0.2491
(21/22) Batch: 0.825s | TOTAL: 0min | ETA: 0min | Loss: 0.2509
Validation: (1/10) Batch: 1.318s | TOTAL: 0min | ETA: 0min | Loss: 0.2885
Validation: (6/10) Batch: 0.459s | TOTAL: 0min | ETA: 0min | Loss: 0.2409

Epoch: [22 | 35] LR: 0.000010
(1/22) Batch: 1.907s | TOTAL: 0min | ETA: 1min | Loss: 0.3034
(11/22) Batch: 0.877s | TOTAL: 0min | ETA: 0min | Loss: 0.3017
(21/22) Batch: 0.827s | TOTAL: 0min | ETA: 0min | Loss: 0.2727
Validation: (1/10) Batch: 1.353s | TOTAL: 0min | ETA: 0min | Loss: 0.1933
Validation: (6/10) Batch: 0.464s | TOTAL: 0min | ETA: 0min | Loss: 0.2624

Epoch: [23 | 35] LR: 0.000010
(1/22) Batch: 1.885s | TOTAL: 0min | ETA: 1min | Loss: 0.2126
(11/22) Batch: 0.873s | TOTAL: 0min | ETA: 0min | Loss: 0.2585
(21/22) Batch: 0.824s | TOTAL: 0min | ETA: 0min | Loss: 0.2529
Validation: (1/10) Batch: 1.386s | TOTAL: 0min | ETA: 0min | Loss: 0.3646
Validation: (6/10) Batch: 0.470s | TOTAL: 0min | ETA: 0min | Loss: 0.2823

Epoch: [24 | 35] LR: 0.000010
(1/22) Batch: 1.914s | TOTAL: 0min | ETA: 1min | Loss: 0.3443
(11/22) Batch: 0.875s | TOTAL: 0min | ETA: 0min | Loss: 0.2475
(21/22) Batch: 0.824s | TOTAL: 0min | ETA: 0min | Loss: 0.2509
Validation: (1/10) Batch: 1.284s | TOTAL: 0min | ETA: 0min | Loss: 0.2714
Validation: (6/10) Batch: 0.454s | TOTAL: 0min | ETA: 0min | Loss: 0.2240

Epoch: [25 | 35] LR: 0.000010
(1/22) Batch: 1.859s | TOTAL: 0min | ETA: 1min | Loss: 0.1900
(11/22) Batch: 0.873s | TOTAL: 0min | ETA: 0min | Loss: 0.2444
(21/22) Batch: 0.824s | TOTAL: 0min | ETA: 0min | Loss: 0.2344
Validation: (1/10) Batch: 1.319s | TOTAL: 0min | ETA: 0min | Loss: 0.2612
Validation: (6/10) Batch: 0.459s | TOTAL: 0min | ETA: 0min | Loss: 0.2908

Epoch: [26 | 35] LR: 0.000010
(1/22) Batch: 1.850s | TOTAL: 0min | ETA: 1min | Loss: 0.1284
(11/22) Batch: 0.869s | TOTAL: 0min | ETA: 0min | Loss: 0.2623
(21/22) Batch: 0.822s | TOTAL: 0min | ETA: 0min | Loss: 0.2561
Validation: (1/10) Batch: 1.374s | TOTAL: 0min | ETA: 0min | Loss: 0.2276
Validation: (6/10) Batch: 0.470s | TOTAL: 0min | ETA: 0min | Loss: 0.2081

Epoch: [27 | 35] LR: 0.000010
(1/22) Batch: 1.970s | TOTAL: 0min | ETA: 1min | Loss: 0.2088
(11/22) Batch: 0.877s | TOTAL: 0min | ETA: 0min | Loss: 0.2181
(21/22) Batch: 0.827s | TOTAL: 0min | ETA: 0min | Loss: 0.2353
Validation: (1/10) Batch: 1.230s | TOTAL: 0min | ETA: 0min | Loss: 0.3263
Validation: (6/10) Batch: 0.448s | TOTAL: 0min | ETA: 0min | Loss: 0.2839

Epoch: [28 | 35] LR: 0.000010
(1/22) Batch: 1.938s | TOTAL: 0min | ETA: 1min | Loss: 0.2855
(11/22) Batch: 0.877s | TOTAL: 0min | ETA: 0min | Loss: 0.2694
(21/22) Batch: 0.827s | TOTAL: 0min | ETA: 0min | Loss: 0.2519
Validation: (1/10) Batch: 1.378s | TOTAL: 0min | ETA: 0min | Loss: 0.2380
Validation: (6/10) Batch: 0.470s | TOTAL: 0min | ETA: 0min | Loss: 0.2334

Epoch: [29 | 35] LR: 0.000010
(1/22) Batch: 1.913s | TOTAL: 0min | ETA: 1min | Loss: 0.2847
(11/22) Batch: 0.878s | TOTAL: 0min | ETA: 0min | Loss: 0.2471
(21/22) Batch: 0.826s | TOTAL: 0min | ETA: 0min | Loss: 0.2462
Validation: (1/10) Batch: 1.369s | TOTAL: 0min | ETA: 0min | Loss: 0.1940
Validation: (6/10) Batch: 0.468s | TOTAL: 0min | ETA: 0min | Loss: 0.2432

Epoch: [30 | 35] LR: 0.000010
(1/22) Batch: 1.866s | TOTAL: 0min | ETA: 1min | Loss: 0.2590
(11/22) Batch: 0.872s | TOTAL: 0min | ETA: 0min | Loss: 0.2473
(21/22) Batch: 0.823s | TOTAL: 0min | ETA: 0min | Loss: 0.2332
Validation: (1/10) Batch: 1.282s | TOTAL: 0min | ETA: 0min | Loss: 0.2149
Validation: (6/10) Batch: 0.454s | TOTAL: 0min | ETA: 0min | Loss: 0.2583

Epoch: [31 | 35] LR: 0.000010
(1/22) Batch: 1.936s | TOTAL: 0min | ETA: 1min | Loss: 0.2577
(11/22) Batch: 0.880s | TOTAL: 0min | ETA: 0min | Loss: 0.2501
(21/22) Batch: 0.828s | TOTAL: 0min | ETA: 0min | Loss: 0.2460
Validation: (1/10) Batch: 1.307s | TOTAL: 0min | ETA: 0min | Loss: 0.2477
Validation: (6/10) Batch: 0.463s | TOTAL: 0min | ETA: 0min | Loss: 0.2273

Epoch: [32 | 35] LR: 0.000010
(1/22) Batch: 1.890s | TOTAL: 0min | ETA: 1min | Loss: 0.2345
(11/22) Batch: 0.879s | TOTAL: 0min | ETA: 0min | Loss: 0.2610
(21/22) Batch: 0.829s | TOTAL: 0min | ETA: 0min | Loss: 0.2467
Validation: (1/10) Batch: 1.311s | TOTAL: 0min | ETA: 0min | Loss: 0.2835
Validation: (6/10) Batch: 0.459s | TOTAL: 0min | ETA: 0min | Loss: 0.2470

Epoch: [33 | 35] LR: 0.000010
(1/22) Batch: 1.847s | TOTAL: 0min | ETA: 1min | Loss: 0.1984
(11/22) Batch: 0.870s | TOTAL: 0min | ETA: 0min | Loss: 0.2348
(21/22) Batch: 0.823s | TOTAL: 0min | ETA: 0min | Loss: 0.2315
Validation: (1/10) Batch: 1.265s | TOTAL: 0min | ETA: 0min | Loss: 0.2869
Validation: (6/10) Batch: 0.451s | TOTAL: 0min | ETA: 0min | Loss: 0.3124

Epoch: [34 | 35] LR: 0.000010
(1/22) Batch: 1.863s | TOTAL: 0min | ETA: 1min | Loss: 0.1978
(11/22) Batch: 0.874s | TOTAL: 0min | ETA: 0min | Loss: 0.2300
(21/22) Batch: 0.825s | TOTAL: 0min | ETA: 0min | Loss: 0.2238
Validation: (1/10) Batch: 1.314s | TOTAL: 0min | ETA: 0min | Loss: 0.3083
Validation: (6/10) Batch: 0.459s | TOTAL: 0min | ETA: 0min | Loss: 0.2708

Epoch: [35 | 35] LR: 0.000010
(1/22) Batch: 1.798s | TOTAL: 0min | ETA: 1min | Loss: 0.2902
(11/22) Batch: 0.865s | TOTAL: 0min | ETA: 0min | Loss: 0.2305
(21/22) Batch: 0.823s | TOTAL: 0min | ETA: 0min | Loss: 0.2313
Validation: (1/10) Batch: 1.331s | TOTAL: 0min | ETA: 0min | Loss: 0.2855
Validation: (6/10) Batch: 0.461s | TOTAL: 0min | ETA: 0min | Loss: 0.2528
